package main

import (
	"context"
	"encoding/json"
	"fmt"
	"frozen-go-project/test/idtoken"
)

var IdToken = "eyJhbGciOiJSUzI1NiIsImtpZCI6ImRlOTU1NmFkNDY4MDMxMmMxMTdhZmFlZjI5MjBmNWY5OWE0Yzc5ZmQiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiIxOTM2MDAyNzI1MDEtODN2YmUwdnRiZm9oazIzb2tjMm5idjZsaGZsN3JlcmUuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiIxOTM2MDAyNzI1MDEtYzZlN2piZW1zMTl0c29obTg1YmtzNmNhcXVmMXNrdmEuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDQ4Mzk3OTE3ODM2MTgwMzU3OTAiLCJlbWFpbCI6ImlhbWh1amllYmluQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoi6IOh5p2w5b2sIiwicGljdHVyZSI6Imh0dHBzOi8vbGg1Lmdvb2dsZXVzZXJjb250ZW50LmNvbS8tNF8yREplajRTZ00vQUFBQUFBQUFBQUkvQUFBQUFBQUFBQUEvQU1adXVjbUV4Qms5c1ZjeHA2aGNpMUJHSUwyNWRfMVNJQS9zOTYtYy9waG90by5qcGciLCJnaXZlbl9uYW1lIjoi5p2w5b2sIiwiZmFtaWx5X25hbWUiOiLog6EiLCJsb2NhbGUiOiJ6aC1DTiIsImlhdCI6MTYxOTQxNTE1OSwiZXhwIjoxNjE5NDE4NzU5fQ.Y3YEr6IU3OIBBVhK8B25jRp0l_wPI5qjlFcHNpyIMKzzjZ2QYbPErczDWNk3He0JgGcmAQxuVsTftP5dozuqmsCQ3VuZSvDnHWhJKMgNF5DZ-Nu7eNKBVzheI6-yB2jkjrP2dLILyf7N0coIfFbYzxa_j8pS0hIgOxcfY3reFgtBJ1iyQIeL66_z-jPeLnKhWSgJBSbrHDLFadckWCaJpJwd4nXmwSLBMliUHR_Zv7K29jDnU42s5JCRMNlPab831wz9XZxyPOaCjLdD4pAJPukb8EUtuOD0gGEpydDkdNqleHqQCnJrzH9NqKuclRllY9GXDALlGpau8OjF4TiVUQ"
var ClientId = "193600272501-c6e7jbems19tsohm85bks6caquf1skva.apps.googleusercontent.com"

type GoogleUserInfo struct {
	ID      string `json:"sub"`
	Name    string `json:"name"`
	Picture string `json:"picture"`
	Email   string `json:"email"`
}

func main() {
	IdToken = "eyJhbGciOiJSUzI1NiIsImtpZCI6Ijc3MjA5MTA0Y2NkODkwYTVhZWRkNjczM2UwMjUyZjU0ZTg4MmYxM2MiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI4NDc5MzE1NTg2NzctZ3N1dDZraHUwdTZtZjJ1ZG05NzRvZjVsNDM4cWthbDAuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI4NDc5MzE1NTg2NzctaDQ2MjcyNHJ1M2Y0b3Y0N2Flbm52cm9kMjB0YjIycnQuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDQ4Mzk3OTE3ODM2MTgwMzU3OTAiLCJlbWFpbCI6ImlhbWh1amllYmluQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoi6IOh5p2w5b2sIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hLS9BT2gxNEdoaGVzQ25kdWxNdEE1RmRDNFlZeDFZbktpY2RQVGh3QWs1WU5wOT1zOTYtYyIsImdpdmVuX25hbWUiOiLmnbDlvawiLCJmYW1pbHlfbmFtZSI6IuiDoSIsImxvY2FsZSI6InpoLUNOIiwiaWF0IjoxNjE5NjA5Mzk3LCJleHAiOjE2MTk2MTI5OTd9.kd--McdNJSl8NYiiKKi35g4LeSj4i74n7fkkeq_rcrzjWrE0dCwtmuhNMcgt_-TLEV2c1QbKyXJVByBe0aNIA2uWpjbjMB8LhcUjAV_YJdNgNEJzdjrR-sRv2TKD6hfOyYzMcORdhGqX6G2PE71JIi_oOkGbIwDRBITA-hw5rb4ZnjH1TCDthSx0yM50zuBXOsbNKW4qLK5Gi4fbNvycv71TcAbqIBUjtX7L3HeCwINmjjJoXB32QttwuwR1zZBgHrKYF2jV3OeTrdTxAVIYXARXTbEwrbAJIjocOWkyly_WIv4-_0J9zV7_tUS3e5fBiaeMNWrESuI3VZeH-v17Rg"
	ClientId = "847931558677-h462724ru3f4ov47aennvrod20tb22rt.apps.googleusercontent.com"
	payload, err := idtoken.Validate(context.Background(), IdToken, ClientId)
	if err != nil {
		println(err.Error())
		return
	}
	println(payload, err)
	googleUserInfo := new(GoogleUserInfo)
	jj, _ := json.Marshal(payload.Claims)
	json.Unmarshal(jj, &googleUserInfo)
	fmt.Printf("%+v", googleUserInfo)
}
